{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Civic Companion - Your Trusted Legal Guide</title>
  <meta name="description"
    content="Learn the Law, Guard your Rights, Grab the Schemes in your sights - Your complete guide to Indian laws, human rights, and government schemes." />
  <link rel="icon" href="{% static 'images/icon.png' %}" alt="#icon" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap"
    rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link rel="stylesheet" href="{% static 'master.css' %}" />

</head>

<body>
  <!-- Navigation Bar -->
  <div class="bar" id="bar">
    <div style="display: flex; align-items: center;">
      <div class="head-logo">
        <img src="{% static 'images/logo.png' %}" alt="Civic Companion" />
      </div>
      <h2>Civic Companion</h2>
    </div>

    <!-- Hamburger Icon -->
    <div class="hamburger-menu" id="hamburger-menu">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>

    <!-- Navigation Menu -->
    <nav class="nav-menu" id="nav-menu">
      <ul>
        <li><a href="{% url 'home' %}">Home</a></li>
        <li><a href="{% url 'category' %}">Services</a></li>
        <li><a href="{% url 'offerings' %}">Offerings</a></li>
        <li><a href="{% url 'about' %}">About</a></li>
        <li><a href="{% url 'contact' %}">Contact</a></li>
      </ul>
    </nav>

    <!-- Menu Tabs -->
    <div class="body">
      <div class="nav-links">
        <a href="{% url 'home' %}" class="nav-item active">Home</a>
        <a href="{% url 'offerings' %}" class="nav-item">Offerings</a>
        <a href="{% url 'about' %}" class="nav-item">About</a>
        <a href="{% url 'contact' %}" class="nav-item">Contact</a>
      </div>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero-modern" id="hero">
    <div class="container hero-container">
      <div class="hero-text-content">
        <h1 class="hero-headline">FIRST LEGAL<br>GUIDANCE YOU<br>SHOULD TRUST</h1>
        <p class="hero-subhead">Helping individuals and businesses move forward with trusted legal strategies and proven
          results.</p>
        <div class="hero-buttons">
          <a href="{% url 'offerings' %}" class="btn-primary">Get Started <i class="fas fa-arrow-right"></i></a>
          <button id="chatbot-open-btn" class="btn-secondary">Chatbot <i class="fas fa-comment-dots"></i></button>
        </div>
      </div>
      <div class="hero-visuals">
        <div class="statue-container">
          <img src="{% static 'images/hero_statue.png' %}" alt="Lady Justice" class="hero-statue">
        </div>
      </div>
    </div>
  </section>

  <!-- Chatbot Modal -->
  <div class="chat-modal-overlay" id="chat-modal-overlay">
    <div class="chat-modal">
      <div class="chat-header">
        <span>Legal Assistant</span>
        <button class="chat-close-btn" id="chat-close-btn"><i class="fas fa-times"></i></button>
      </div>
      <div class="chat-body" id="chat-body">
        <div class="chat-message bot">
          Hello! I am your legal assistant. Ask me anything about sections, acts, or rights in our database.
        </div>
      </div>
      <div class="chat-footer">
        <input type="text" class="chat-input" id="chat-input" placeholder="Type your question...">
        <button class="chat-send-btn" id="chat-send-btn"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2026 Civic Companion. All rights reserved.</p>
    </div>
  </footer>

  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({ pageLanguage: 'en', includedLanguages: 'en,ta,ml,te,hi', layout: google.translate.TranslateElement.InlineLayout.SIMPLE }, 'google_translate_element');
    }
  </script>
  <script type="text/javascript"
    src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  <script src="{% static 'assets/script.js' %}"></script>
  <script>
    // Chatbot Logic
    document.addEventListener('DOMContentLoaded', function () {
      const modal = document.getElementById('chat-modal-overlay');
      const openBtn = document.getElementById('chatbot-open-btn');
      const closeBtn = document.getElementById('chat-close-btn');
      const sendBtn = document.getElementById('chat-send-btn');
      const input = document.getElementById('chat-input');
      const chatBody = document.getElementById('chat-body');

      // Open Modal
      if (openBtn) {
        openBtn.addEventListener('click', function (e) {
          e.preventDefault();
          modal.classList.add('open'); // Use class for transition
          input.focus();
        });
      }

      // Close Modal
      closeBtn.addEventListener('click', () => {
        modal.classList.remove('open');
      });

      // Close on outside click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('open');
        }
      });

      // Send Message
      function sendMessage() {
        const query = input.value.trim();
        if (!query) return;

        // Add User Message
        appendMessage(query, 'user');
        input.value = '';

        // Loading state
        const loadingId = appendMessage('<span class="typing-dots">Searching</span>', 'bot', true);

        // Fetch Response
        fetch(`/chatbot/?message=${encodeURIComponent(query)}`)
          .then(response => response.json())
          .then(data => {
            // Remove loading message
            const loadingMsg = document.getElementById(loadingId);
            if (loadingMsg) loadingMsg.remove();

            // Add Bot Response
            appendMessage(data.response, 'bot', true);
          })
          .catch(error => {
            console.error('Error:', error);
            const loadingMsg = document.getElementById(loadingId);
            if (loadingMsg) loadingMsg.remove();
            appendMessage("Sorry, something went wrong. Please try again.", 'bot');
          });
      }

      sendBtn.addEventListener('click', sendMessage);
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
      });

      function appendMessage(text, sender, isHTML = false) {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('chat-message', sender);
        if (isHTML) {
          msgDiv.innerHTML = text;
        } else {
          msgDiv.textContent = text;
        }

        // Generate unique ID for removal if needed (like loading)
        const id = 'msg-' + Date.now();
        msgDiv.id = id;

        chatBody.appendChild(msgDiv);
        chatBody.scrollTop = chatBody.scrollHeight;
        return id;
      }
    });

    // Hamburger menu toggle
    document.getElementById('hamburger-menu').addEventListener('click', function () {
      this.classList.toggle('active');
      document.getElementById('nav-menu').classList.toggle('active');
    });

    // Smooth scroll for nav links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });
  </script>
</body>

</html>
